@startuml diagrammeAll
skinparam classAttributeIconSize 0

!include diagrammeFlow.txt!0
 
Flow --> "1" Pipeline

class Pipeline {
  -no_workers: int

  addStage(): void
  nbWorkers(): int
  setNbWorkers(): void
  isParallel(): bool
  run(): void
} 

Pipeline --> "stages\n0..*" Stage


Pipeline --|> Node
Farm --|> Node
Worker --|> Node

Pipeline --> ff_pipeline

class ff_pipeline {
}

class Farm {
  nbWorkers(): int
  addStage(): void
}

Farm --> "1..*" Worker
Farm --> ff_farm

class Worker {
}

class Node {
  addStage(): void
}

Node --> ff_node

class ff_node {
}

class ff_farm {
}

abstract class Stage {
}


class BaseStage<TOperator,bool> implements Stage {
  addOperator(): void
}

BaseStage --> "operators\n1..*" BaseOperator 

abstract class BaseOperator {
  +=(): BaseOperator
}

class LimitOperator {
}

class MapOperator {
}

class LinesFromFileOperator {
}

CountOperator --|> BaseOperator
LimitOperator --|> BaseOperator
LinesFromFileOperator --|> BaseOperator
MapOperator --|> BaseOperator

class Collectors<TOperator> {
  value(): Value
  -combineOperatorsResults(): void
}

Collectors --|> BaseStage


@enduml
